import{B as t,a as e,b as s,c as a,d as r,e as o,f as n,g as i,h as l,i as c,j as u,k as d,l as p,m as h,n as m,V as f,o as g}from"./vendor.56e3e040.js";!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(s){const a=new URL(t,location),r=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((s,o)=>{const n=new URL(t,a);if(self[e].moduleMap[n])return s(self[e].moduleMap[n]);const i=new Blob([`import * as m from '${n}';`,`${e}.moduleMap['${n}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){o(new Error(`Failed to import: ${t}`)),r(l)},onload(){s(self[e].moduleMap[n]),r(l)}});document.head.appendChild(l)})),self[e].moduleMap={}}}("https://cooty.github.io/vue-weather-app/assets/");class y{constructor(t,e){this.lat=t,this.lon=e}}const _={debug:!1,state:{weatherData:null,city:"",coords:null,isLoading:!0,isError:!1,errorMessage:"",isRightSectionOpened:!1},setWeatherData(t){this.debug&&console.log("setWeatherDataAction triggered with",t),this.state.weatherData=t},setCity(t){this.debug&&console.log("setCity triggered with",t),this.state.city=t},setCoords(t){this.debug&&console.log("setCoords triggered with",t),this.state.coords=t},setIsLoading(t){this.debug&&console.log("setIsLoading triggered with",t),this.state.isLoading=t},setIsError(t){this.debug&&console.log("setIsError triggered with",t),this.state.isError=t},setErrorMessage(t){this.debug&&console.log("setErrorMessage triggered with",t),this.state.errorMessage=t},setIsRightSectionOpened(t){this.debug&&console.log("setIsRightSectionOpened triggered with",t),this.state.isRightSectionOpened=t}};Object.freeze(_);function v(t,e,s,a,r,o,n,i){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),a&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),n?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},c._ssrRegister=l):r&&(l=i?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:c}}const b={};var w=v({name:"QueryForm",components:{BForm:t,BFormInput:e,BIconSearch:s,BButton:a},data:()=>({city:"",appState:_.state}),computed:{valid:function(){return this.city}},mounted(){this.$bubble("update-weather",{coords:new y(parseFloat((180*Math.random()-90).toFixed(8)),parseFloat((360*Math.random()-180).toFixed(8))),options:{lang:this.$i18n.locale}})},methods:{submitHandler(){this.$bubble("update-weather",{city:this.city,options:{lang:this.$i18n.locale}})}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-form",{attrs:{inline:""},on:{submit:function(e){return e.preventDefault(),t.submitHandler.apply(null,arguments)}}},[s("label",{staticClass:"sr-only",attrs:{for:"input-city"}},[t._v(" "+t._s(t.$t("messages.cityLabel"))+" ")]),s("b-form-input",{staticClass:"query-form-city",attrs:{id:"input-city",name:"city",placeholder:t.$t("messages.cityPlaceholder"),required:""},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}}),s("b-button",{staticClass:"query-form-submit",attrs:{type:"submit",variant:"primary",disabled:!t.valid||t.appState.isLoading,"aria-label":t.$t("messages.submit")}},[s("b-icon-search")],1)],1)}),[],!1,(function(t){for(let e in b)this[e]=b[e]}),"5deff4c8",null,null);w.options.__file="src/domain/query/QueryForm.vue";var C=w.exports;const $={name:"TextRow",props:{bold:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},noBottomMargin:{type:Boolean,default:!1}}},x={};var S=v($,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("p",{class:{"font-weight-bold":t.bold,"text-muted":t.muted,"mb-0":t.noBottomMargin}},[t._t("default")],2)}),[],!1,(function(t){for(let e in x)this[e]=x[e]}),null,null,null);S.options.__file="src/ui/TextRow.vue";var E=S.exports;const L={};var B=v({name:"Divider"},(function(){var t=this.$createElement;return(this._self._c||t)("hr",{staticClass:"border-top my-2"})}),[],!1,(function(t){for(let e in L)this[e]=L[e]}),null,null,null);B.options.__file="src/ui/Divider.vue";var F=B.exports;const k={};var D=v({name:"FormattedTemperature",props:{temp:{type:Number,required:!0}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"text-nowrap"},[t._v(" "+t._s(Math.floor(t.temp))+"°C ")])}),[],!1,(function(t){for(let e in k)this[e]=k[e]}),null,null,null);D.options.__file="src/domain/display/FormattedTemperature.vue";var R=D.exports;class I{constructor(t,e,s,a,r){this.temp=t,this.description=e,this.feelsLike=s,this.humidity=a,this.pressure=r}}const M={};var j=v({name:"Display",components:{BCard:r,TextRow:E,Divider:F,BBadge:o,FormattedTemperature:R},props:{weatherData:{type:I,default:null},coords:{type:y,default:null},city:{type:String,default:""}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-card",{staticClass:"shadow",attrs:{tag:"article"}},[s("text-row",{attrs:{bold:!0}},[t.city?[t._v(" "+t._s(t.$t("messages.weatherForCity",{city:t.city}))+" ")]:[t._v(" "+t._s(t.$t("messages.weatherForCoordinates",{lat:t.coords.lat,lon:t.coords.lon}))+" ")]],2),s("div",{staticClass:"d-flex flex-nowrap justify-content-between"},[s("h1",{staticClass:"h2"},[s("formatted-temperature",{attrs:{temp:t.weatherData.temp}})],1),s("div",[s("b-badge",{attrs:{variant:"info"}},[t._v(" "+t._s(t.weatherData.description)+" ")])],1)]),s("text-row",[t._v(" "+t._s(t.$t("messages.feelsLike"))+" "),s("formatted-temperature",{attrs:{temp:t.weatherData.feelsLike}})],1),s("divider"),s("text-row",{attrs:{muted:!0}},[t._v(" "+t._s(t.$t("messages.humidity"))+": "+t._s(t.weatherData.humidity)+"% ")]),s("text-row",{attrs:{muted:!0,"no-bottom-margin":!0}},[t._v(" "+t._s(t.$t("messages.pressure"))+": "+t._s(t.weatherData.pressure)+"hPa ")])],1)}),[],!1,(function(t){for(let e in M)this[e]=M[e]}),null,null,null);j.options.__file="src/domain/display/Display.vue";var O=j.exports;const A={};var T=v({name:"Wrapper",components:{BContainer:n,BRow:i,BCol:l}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-container",{attrs:{fluid:"md"}},[s("b-row",{staticClass:"justify-content-center align-items-center"},[s("b-col",{attrs:{cols:"12",sm:"10",md:"8",lg:"6",xl:"5"}},[t._t("default")],2)],1)],1)}),[],!1,(function(t){for(let e in A)this[e]=A[e]}),null,null,null);T.options.__file="src/ui/Wrapper.vue";var W=T.exports;const H={};var U=v({name:"AppMain"},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("main",{staticClass:"position-relative d-flex flex-column h-100"},[t._t("default")],2)}),[],!1,(function(t){for(let e in H)this[e]=H[e]}),null,null,null);U.options.__file="src/ui/AppMain.vue";var N=U.exports;const P={};var z=v({name:"AppHeader",components:{BNavbar:c,BContainer:n,BRow:i,BCol:l,BIconGear:u,BIconX:d},data:()=>({appState:_.state}),methods:{toggle(){_.setIsRightSectionOpened(!this.appState.isRightSectionOpened)}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-navbar",{staticClass:"shadow-sm",attrs:{sticky:!0,type:"light",variant:"light"}},[s("b-container",{attrs:{fluid:"lg"}},[s("b-row",{staticClass:"w-100 no-gutters",attrs:{"align-h":"between"}},[s("b-col",{attrs:{cols:10,sm:9,md:8,lg:6}},[t._t("left")],2),s("b-col",{staticClass:"d-flex justify-content-end position-relative",attrs:{cols:2,sm:3,md:4,lg:6}},[s("button",{staticClass:"right-slot-toggler-lt-md d-md-none h4 mb-0 text-secondary",on:{click:t.toggle}},[t.appState.isRightSectionOpened?[s("b-icon-x")]:[s("b-icon-gear")]],2),s("div",{staticClass:"right-slot p-2 p-md-0 rounded d-md-flex",class:{opened:t.appState.isRightSectionOpened}},[t._t("right")],2)])],1)],1)],1)}),[],!1,(function(t){for(let e in P)this[e]=P[e]}),"6b285008",null,null);z.options.__file="src/ui/AppHeader.vue";var q=z.exports;const G={};var K=v({name:"AppContent"},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("section",{staticClass:"app-content d-flex flex-column justify-content-center"},[t._t("default")],2)}),[],!1,(function(t){for(let e in G)this[e]=G[e]}),"70f25bb9",null,null);K.options.__file="src/ui/AppContent.vue";var V=K.exports;const Q=Object.freeze({EN:"en",DE:"de",BG:"bg",HU:"hu"});const X={};var J=v({name:"LanguageChanger",components:{BFormSelect:p},data:()=>({languages:[{text:"English",value:Q.EN},{text:"Deutsch",value:Q.DE},{text:"Magyar",value:Q.HU},{text:"български",value:Q.BG}]}),methods:{changeHandler(t){const e={options:{lang:t}};_.state.coords?e.coords=_.state.coords:e.city=_.state.city,this.$bubble("update-weather",e)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("b-form-select",{attrs:{options:t.languages},on:{change:t.changeHandler},model:{value:t.$i18n.locale,callback:function(e){t.$set(t.$i18n,"locale",e)},expression:"$i18n.locale"}})}),[],!1,(function(t){for(let e in X)this[e]=X[e]}),null,null,null);J.options.__file="src/infrastructure/i18n/LanguageChanger.vue";var Y=J.exports;const Z="https://api.openweathermap.org/data/2.5/weather",tt="&appid=af70a8ed8f9ec89b897089b1e7ad7ee9&units=metric",et=async t=>{const e=await fetch(t);if(200!==e.status)throw new Error("We couldn't get the weather data for that location");return await e.json()},st={makeKey:t=>`_wa_${t}`,saveToCache(t,e){try{sessionStorage.setItem(this.makeKey(t),JSON.stringify(e))}catch(s){console.warn(s)}},getFromCache(t){try{const e=sessionStorage.getItem(this.makeKey(t));return!!e&&JSON.parse(e)}catch(e){return console.warn(e),!1}}};Object.freeze(st);const at={};var rt=v({name:"App",components:{QueryForm:C,Display:O,BSpinner:h,BAlert:m,Wrapper:W,LanguageChanger:Y,AppHeader:q,AppMain:N,AppContent:V},data:()=>({appState:_.state}),methods:{onUpdateWeatherHandler:async t=>{var e;let s;(e=_).setIsLoading(!0),e.setErrorMessage(""),e.setIsError(!1),e.setIsRightSectionOpened(!1);try{const e=`${t.coords?""+t.coords.lat+t.coords.lon:t.city}${t.options.lang}`,a=st.getFromCache(e);if(a)s=a;else{s=(t=>{const{main:e,weather:s}=t;if(!(e&&s&&s[0]&&s[0].description&&e.feels_like&&e.humidity&&e.pressure))throw new Error("Can't find all the necessary data in the API response");return new I(e.temp,s[0].description,e.feels_like,e.humidity,e.pressure)})(t.coords?await(async(t,e,s)=>await et(`${Z}?lat=${t}&lon=${e}${tt}&lang=${s.lang}`))(t.coords.lat,t.coords.lon,t.options):await(async(t,e)=>await et(`${Z}?q=${t}${tt}&lang=${e.lang}`))(t.city,t.options)),st.saveToCache(e,s)}t.coords?((t,e,s)=>{s.setWeatherData(t),s.setCoords(e)})(s,t.coords,_):((t,e,s)=>{s.setWeatherData(t),s.setCoords(null),s.setCity(e)})(s,t.city,_)}catch(a){((t,e)=>{e.setIsError(!0),e.setErrorMessage(t.message)})(a,_)}finally{_.setIsLoading(!1)}}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("app-main",{on:{"update-weather":t.onUpdateWeatherHandler}},[s("app-header",{scopedSlots:t._u([{key:"left",fn:function(){return[s("query-form")]},proxy:!0},{key:"right",fn:function(){return[s("language-changer")]},proxy:!0}])}),s("app-content",[s("wrapper",[!t.appState.weatherData||t.appState.isLoading||t.appState.isError?t.appState.isLoading?[s("div",{staticClass:"text-center"},[s("b-spinner",{attrs:{title:t.$t("messages.loading"),variant:"primary",label:t.$t("messages.loading")}})],1)]:t.appState.isError?[s("b-alert",{attrs:{show:"",variant:"danger"}},[t._v(" "+t._s(t.appState.errorMessage)+" ")])]:t._e():[s("display",{attrs:{"weather-data":t.appState.weatherData,city:t.appState.city,coords:t.appState.coords}})]],2)],1)],1)}),[],!1,(function(t){for(let e in at)this[e]=at[e]}),null,null,null);rt.options.__file="src/application/App.vue";var ot=rt.exports;f.use(g);const nt={en:{messages:{weatherForCity:"The weather for {city} is:",weatherForCoordinates:"The weather for a random coordinate (latitude: {lat}, longitude: {lon}) is:",feelsLike:"feels like",humidity:"Humidity",pressure:"Pressure",cityLabel:"City:",cityPlaceholder:"Type your city",submit:"Check the weather!",loading:"Loading..."}},de:{messages:{weatherForCity:"Das Wetter für {city} ist:",weatherForCoordinates:"Das Wetter für eine zufällige Koordinate (Breite: {lat}, Längengrad: {lon}) ist:",feelsLike:"fühlt sich an wie",humidity:"Feuchtigkeit",pressure:"Luftdruck",cityLabel:"Stadt:",cityPlaceholder:"Geben Sie Ihre Stadt ein",submit:"Wetter anschauen!",loading:"Wird geladen..."}},hu:{messages:{weatherForCity:"Aktuális időjárás, {city}:",weatherForCoordinates:"Időjárás egy véletlenszerű ponton (szélesség: {lat}, hosszúság: {lon}):",feelsLike:"érzésre",humidity:"Páratartalom",pressure:"Nyomás",cityLabel:"Város:",cityPlaceholder:"Írj be egy várost",submit:"Lássuk az időjárást!",loading:"Betöltés..."}},bg:{messages:{weatherForCity:"Времето за {city} е:",weatherForCoordinates:"Времето за произволна координата (географска ширина: {lat}, дължина: {lon}) е:",feelsLike:"се чувства като",humidity:"Влажност",pressure:"Налягане",cityLabel:"Град:",cityPlaceholder:"Въведете вашия град",submit:"Проверете времето!",loading:"Зареждане..."}}},it=new g({locale:Q.EN,messages:nt});f.use((t=>{t.prototype.$bubble=function(t,...e){let s=this;do{s.$emit(t,...e),s=s.$parent}while(s)}})),new f({i18n:it,render:t=>t(ot)}).$mount("#app");
